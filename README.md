# Reentrancy Vulnerability in Solidity Transfer Function

This repository demonstrates a common reentrancy vulnerability in Solidity smart contracts and provides a solution.

The `bug.sol` file contains a vulnerable `transfer` function.  A malicious contract can call back into the `transfer` function before the balance is updated, allowing it to repeatedly withdraw funds.  The `bugSolution.sol` file presents a corrected implementation using the Checks-Effects-Interactions pattern to prevent this vulnerability.

## Vulnerability

The vulnerable `transfer` function directly updates the balances before emitting the `Transfer` event.  A malicious contract can call back into the `transfer` function within the same transaction, manipulating the balance before the internal state is properly updated.

## Solution

The solution implements the Checks-Effects-Interactions pattern.  This ensures that the checks are performed first to validate the transaction before any state changes (effects) or external interactions (interactions) are made.

This prevents a malicious contract from manipulating the balance to exceed the available funds before the transfer is fully completed.